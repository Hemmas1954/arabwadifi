<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="theme-color" content="#1B4E65" />
    
    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="المحلّل الذّكي في النّحو الوظيفي - أداة تعليمية تفاعلية لتعلم وممارسة قواعد النحو الوظيفي بطريقة حديثة وسهلة"
    />
    <meta name="keywords" content="نحو وظيفي، تحليل نحوي، تعليم عربي، قواعد النحو، اللغة العربية" />
    <meta name="author" content="المحلّل الذّكي" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="المحلّل الذّكي في النّحو الوظيفي" />
    <meta property="og:description" content="أداة تعليمية تفاعلية لتعلم وممارسة قواعد النحو الوظيفي" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ar_SA" />
    
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="المحلّل الذّكي في النّحو الوظيفي" />
    <meta name="twitter:description" content="أداة تعليمية تفاعلية لتعلم وممارسة قواعد النحو الوظيفي" />
    
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <!-- DNS Prefetch للخطوط -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    
    <!-- Preconnect للخطوط -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- تحميل الخطوط العربية بأولوية عالية -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&family=Amiri:wght@400;700&family=Cairo:wght@200;300;400;600;700;900&family=Noto+Sans+Arabic:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&family=Amiri:wght@400;700&family=Cairo:wght@200;300;400;600;700;900&family=Noto+Sans+Arabic:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"></noscript>
    
    <!-- CSS للتحسين الأولي -->
    <style>
      /* تحسين التحميل الأولي */
      html {
        font-family: 'Tajawal', 'Cairo', 'Noto Sans Arabic', Tahoma, Arial, sans-serif;
        direction: rtl;
        scroll-behavior: smooth;
        font-display: swap;
      }
      
      body {
        margin: 0;
        font-family: 'Tajawal', 'Cairo', 'Noto Sans Arabic', Tahoma, Arial, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-color: #f8f9fa;
        direction: rtl;
        text-align: right;
        font-display: swap;
        visibility: hidden;
      }
      
      /* إظهار المحتوى عند تحميل الخطوط */
      body.fonts-loaded {
        visibility: visible;
      }
      
      /* شاشة التحميل الأولية */
      .initial-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1B4E65 0%, #2E6A84 50%, #D4A574 100%);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        color: white;
        font-family: 'Tajawal', sans-serif;
        z-index: 9999;
        transition: opacity 0.5s ease-out;
      }
      
      .loader-spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #FFD700;
        animation: spin 1s ease-in-out infinite;
        margin-bottom: 20px;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      .loader-text {
        font-size: 1.2rem;
        font-weight: 600;
        text-align: center;
      }
      
      /* إخفاء المحتوى حتى التحميل */
      #root {
        opacity: 0;
        transition: opacity 0.5s ease-in;
      }
      
      #root.loaded {
        opacity: 1;
      }
      
      /* تحسين عرض الخطوط */
      @font-face {
        font-family: 'Tajawal-fallback';
        src: local('Tahoma'), local('Arial');
        font-display: swap;
      }
    </style>
    
    <title>المحلّل الذّكي في النّحو الوظيفي</title>
  </head>
  <body>
    <noscript>
      <div style="text-align: center; padding: 50px; font-family: Tahoma, Arial; direction: rtl;">
        <h2>عذراً، تحتاج إلى تفعيل JavaScript لتشغيل هذا التطبيق</h2>
        <p>يرجى تفعيل JavaScript في متصفحك والمحاولة مرة أخرى.</p>
      </div>
    </noscript>
    
    <!-- شاشة التحميل الأولية -->
    <div id="initial-loader" class="initial-loader">
      <div class="loader-spinner"></div>
      <div class="loader-text" dir="rtl">
        جاري تحضير المحلّل الذكي...
      </div>
    </div>
    
    <div id="root"></div>
    
    <script>
      // تحسين تحميل الخطوط والأنماط
      (function() {
        let fontsLoaded = false;
        let stylesLoaded = false;
        let reactLoaded = false;
        
        function checkAllLoaded() {
          if (fontsLoaded && stylesLoaded) {
            document.body.classList.add('fonts-loaded');
            document.body.style.visibility = 'visible';
            
            // انتظار تحميل React قبل إخفاء شاشة التحميل
            const checkReact = () => {
              const root = document.getElementById('root');
              if (root && root.children.length > 0) {
                reactLoaded = true;
                hideLoader();
              } else {
                setTimeout(checkReact, 100);
              }
            };
            
            const hideLoader = () => {
              const loader = document.getElementById('initial-loader');
              const root = document.getElementById('root');
              
              if (loader && root) {
                setTimeout(() => {
                  loader.style.opacity = '0';
                  root.classList.add('loaded');
                  setTimeout(() => {
                    loader.style.display = 'none';
                  }, 500);
                }, 200);
              }
            };
            
            // بدء فحص React
            setTimeout(checkReact, 300);
          }
        }
        
        // تحميل الخطوط مع فحص أكثر دقة
        const checkFonts = async () => {
          try {
            if ('fonts' in document) {
              // انتظار تحميل الخطوط المحددة
              const fontPromises = [
                document.fonts.load('16px Tajawal'),
                document.fonts.load('16px Cairo'),
                document.fonts.load('16px "Noto Sans Arabic"')
              ];
              
              await Promise.allSettled(fontPromises);
              
              // التحقق من أن الخطوط متاحة
              const fontChecks = [
                document.fonts.check('16px Tajawal'),
                document.fonts.check('16px Cairo'),
                document.fonts.check('16px "Noto Sans Arabic"')
              ];
              
              if (fontChecks.some(check => check)) {
                fontsLoaded = true;
              } else {
                // استخدام الخطوط الاحتياطية
                setTimeout(() => {
                  fontsLoaded = true;
                }, 500);
              }
            } else {
              // للمتصفحات القديمة
              setTimeout(() => {
                fontsLoaded = true;
              }, 800);
            }
            
            checkAllLoaded();
          } catch (error) {
            console.warn('Font loading failed:', error);
            setTimeout(() => {
              fontsLoaded = true;
              checkAllLoaded();
            }, 1000);
          }
        };
        
        // بدء تحميل الخطوط
        checkFonts();
        
        // تحميل الأنماط
        if (document.readyState === 'complete') {
          stylesLoaded = true;
          checkAllLoaded();
        } else {
          window.addEventListener('load', function() {
            stylesLoaded = true;
            checkAllLoaded();
          });
        }
        
        // احتياطي للتأكد من عدم البقاء في شاشة التحميل
        setTimeout(() => {
          if (!fontsLoaded || !stylesLoaded) {
            fontsLoaded = true;
            stylesLoaded = true;
            checkAllLoaded();
          }
        }, 4000);
        
        // تحسين تجربة المستخدم للشاشات الصغيرة
        const viewport = document.querySelector('meta[name=viewport]');
        if (viewport) {
          viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes';
        }
      })();
    </script>
  </body>
</html>